# wushu[.ukoloff.tk]

Тестовый сайт на GitHub Pages

## Используемые технологии

* [GitHub Pages](https://pages.github.com/) - хостинг **статических** сайтов
  - [Git](http://git-scm.com/)
  - [GitHub](https://github.com/)
* [Jekyll](http://jekyllrb.com/) - программа для генерации статических сайтов
  - Языки разметки
    + [HTML](http://ru.wikipedia.org/wiki/HTML) - основной язык разметки вебстраниц
    + [Markdown](http://ru.wikipedia.org/wiki/Markdown) - простой язык, транслируемый в HTML
    + [Textile](http://ru.wikipedia.org/wiki/Textile_(%D1%8F%D0%B7%D1%8B%D0%BA_%D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%82%D0%BA%D0%B8))
  - [Liquid](http://liquidmarkup.org/) - язык шаблонов для генерации сложных страниц
  - [CSS](http://ru.wikipedia.org/wiki/CSS) - язык описания дизайна Веб-страниц
  - [YAML](http://ru.wikipedia.org/wiki/YAML)
* [Disqus](http://disqus.com/) - сервис комментариев
* [Dot TK](http://www.dot.tk/) - бесплатная регистрация доменных имён .tk

## Установка

### Jekyll

Для установки Jekyll нужно:

1. Установить сначала язык [Ruby](https://www.ruby-lang.org/)

  Лучше всего скачать его с http://rubyinstaller.org/downloads/ (версия 2.0.0, лучше 32-битную версию)

2. Установить компилятор для Ruby-пакетов DevKit

  Скачать его с той же страницы, распаковать в любую папку (например C:\Ruby200\DevKit) и запустить команды
  ```sh
  ruby dk.rb init
  ruby dk.rb install
  ```
3. Установить необходимые пакеты

  ```sh
  gem install jekyll
  gem install jekyll-redirect-from
  gem install wdm
  ```

### Git

Можно пользоваться утилитой командной строки `git`, но это явно не вариант для начинающих. Так что
вариантов два:

- [GitHub для Windows](https://windows.github.com/) - минимум функций, английский язык
- [SourceTree](http://www.sourcetreeapp.com/) - множество возможностей, русский язык, через месяц
требуется бесплатная регистрация

### Редактор

Крайне рекомендуется пользоваться качественным редактором, например [SublimeText](http://www.sublimetext.com/) -
периодически предлагает заплатить, но работает и так ;-)

Рекомендуется добавить в настройки SublimeText (Preferenses / Settings - User)

  ```
    "default_line_ending": "unix",
    "ensure_newline_at_eof_on_save": true,
    "fade_fold_buttons": false,
    "tab_size": 2,
    "translate_tabs_to_spaces": true,
    "trim_trailing_white_space_on_save": true,
    "use_tab_stops": true,
    "word_wrap": false
   ```
### GitHub

Требуется зарегистрировать учётную запись на [GitHub](https://github.com/)

### Dot TK

Если нужно доменное имя в домене .tk, потребуется учётная запись в [Dot TK](http://www.dot.tk/)
(можно использовать учётные записи  [Facebook](https://www.facebook.com/) или
[Google](https://www.google.ru/))

## Файлы в репозитории

### [run.bat](/run.bat)

Запуск Jekyll на локальной машине в отладочном режиме.

Всё содержимое каталога компилируется (в папку [_site](#_site)),
запускается веб-сервер, веб-браузер и начинается процесс отслеживания изменений файлов
в репозитории. При изменении (почти) любого файла он тут же перекомпилируется.

Не отслеживаются только изменения в файле конфигурации ([_config.yml](#_configyml)), если изменения внесены в него,
Jekyll требуется перезапустить.

### [CNAME](/CNAME)

В этом файле размещается доменное имя сайта.

GitHub Pages учитывает содержимое этого файла, чтобы определять, какой сайт (из всех, размещённых на них) следует
показывать на конкретный запрос. Если этого файла нет, то сайт обслуживается по адресу вида `user.github.io/repository`.

Чтобы это работало, где-то в мире должен быть корректно настроен сервер DNS, содержащий запись вида

  ```
  site.name.domain CNAME username.github.io
  ```

### [.gitignore](/.gitignore)

Упомянутые здесь файлы никогда не попадают в репозиторий Git и не отслеживаются системой контроля версий.

### [_config.yml](/_config.yml)

Глобальный файл конфигурации Jekyll.

Здесь (в формате YAML)указаны различные параметры сайта, среди которых:

  - `paginate` - количество новостей на одной странице
  - `paginate_path` - адрес страницы со списком новостей
  - `permalink` - адрес, который получают индивидуальные страницы новостей
  - `exclude` - файлы репозитория, которые Jekyll **не** компилирует на сайт

### [_site](/_site)

Папка, где размещается откомпилированный сайт.

При каждом запуске Jekyll эта папка очищается, Jekyll просматривает все файлы репозитория и копирует их папку _site.
Если файл содержит `YAML Front Matter` (то есть начинается со строки `---`, за которой идут данные в формате YAML
и ещё одна строка `---`), то он не просто копируется, а компилируется.

В частности, файлы с расширением `.md` или `.markdown` преобразуются из формата Markdown в HTML, а файлы `.textile` -
соответственно из формата Textile. Внутри файла исполняются теги Liquid (то есть конструкции {% ... %} и {{ ...}})
и файл может быть дополнительно "обёрнут" в какой-нибудь другой файл (layout).

### [favicon.ico](/favicon.ico)

Иконка, которая показывается браузерами во вкладке сайта (слева от имени).

### [404.md](/404.md)

Страница, которая отображается, если указан несуществующий адрес страницы.

Работает только на GitHub Pages, локальный Jekyll это не поддерживает.

Эта страница, как и любая другая, может использовать не только формат Markdown, но и формат Textile или HTML.

### [index.html](/index.html)

Первая страница сайта.

По соглашению, если адрес вебстраницы заканчивается на `/`, то веб-сервер ищет в папке файл с именем `index.htm` и показывает его.
(Если такого файла нет, то показывается файл [\404.html].

В корневой `index.html` встроен механизм отображения "горячих" новостей. В нём отображаются сначала все новости, помеченные
как `important: true` (в обратном хронологическом порядке), а после этого ещё несколько "обычных" новостей (без `important:`).
Общее количество новостей на главной странице определяется параметром `paginate: ` в YAML Front Matter файла `index.html`,
а если оно там не указано - то глобальным параметром `paginate:` из файла [_config.yml](#_configyml).

Трогать руками этот механизм не рекомендуется, но выше или ниже его можно вставить свой текст.

Для главной страницы отключены комментарии Disqus посредством параметра `no-disqus: true`.

### [xinwen](/xinwen/)

Папка, где Jekyll размещает списки новостей в обратном хронологическом порядке.

Формат списка новостей определяется файлом `index.html` в этой папке.

Количество новостей на страницу задаётся глобальным параметром `paginate:` из файла [_config.yml](#_configyml).

Параметр `important:` в этих списках не учитывается, все новости идут строго по дате и времени.

На этих страницах (списках новостей) также отключены комментарии Disqus посредством параметра `no-disqus: true`.

### [_posts](_posts)

Здесь размещаются исходные файлы индивидуальных новостей.

Файлы здесь обязаны иметь имя вида YYYY-MM-DD-title.*, то есть в имени должны быть указаны дата и финальное имя страницы. Откомпилированный файл
будет помещён в другое место, указанное глобальным параметром `permalink` в файле файла [_config.yml](#_configyml).

В остальном файлы новостей - такие же файлы, как все остальные, они могут создаваться в любом формате (HTML / Markdown / Textile).

В списках новостей отображается не полный текст новости, а её начало. На данным момент ограничителем (местом, где обрезается текст) является
первая пустая строка в тексте новости. Это можно изменить глобальным параметром `excerpt_separator` в файле [_config.yml](#_configyml).

### [_layouts](/_layouts)

Здесь размещаются оформления страниц.

На данный момент имеется только одно оформление - [default](/_layouts/default.html), но при желании можно добавить и другие.

В какое из оформлений будет "обёрнута" вебстраница определяется параметром `layout` в её YAML Front Matter.

### [yangshi](/yangshi)

Здесь хранятся таблицы стилей (CSS), определяющие внешний вид страниц.

На данный момент имеется только одна таблица стилей [qi](/yangshi/qi.css), но при желании можно добавить и другие.

### [huabao](/huabao)

Здесь размещаются файлы изображений.

Как изображения, используемые в служебных целях (фоны, иконки и т.п.), так и иллюстрации к статьям. Рекомендуется продумать структуру
хранения и размещать картинки не в кучу, а раскладывая по логично организованным папкам.

Если картинка используется только в одной статье, то можно разместить её не здесь, а прямо возле самой статьи.
Впрочем, это должно определяться политикой сайта.

### [wen](/wen)

Здесь размещаются тексты статей на сайте.

По аналогии с картинками (но ещё более строго), рекомендуется хранить их не одной кучей, а раскладывать по папкам.
Название папки не является выделенным, её можно назвать как угодно, или можно создать несколько папок в корне (и в каждой несколько подпапок).
Можно даже размещать некоторые статьи непосредственно в корне сайта/репозитория, но обычно это приводит к замусориванию и не
рекомендуется.

### [_data](/_data)

Здесь размещаются вспомогательные данные в формате YAML.

На данный момент здесь размещены описания горизонтального меню [hmenu](/_data/hmenu.yml) и вертикального меню [vmenu](/_data/vmenu.yml), а также
список ссылок, показываемых в углу отладочной (не на GitHub Pages) версии сайта [devlinks](/_data/devlinks.yml).

